// Объявление функции week с тремя параметрами:
// label_data - массив меток для оси X (даты/дни недели)
// count_data - массив значений для оси Y (количество слов)
// id - идентификатор HTML элемента canvas, куда будет отрисован график
const week = (label_data, count_data, id) => {
    console.log(count_data)
    // Переменная для хранения экземпляра графика
    // Это позволяет управлять им (например, перерисовывать)
    let chartInstance = null;

    // Получаем ссылку на canvas элемент по его id
    const ctx = document.getElementById(id);

    // Проверка: если элемент не найден, выводим ошибку и выходим
    if (!ctx) {
        console.error(`Element with id "${id}" not found`);
        return;
    }

    // Удаляем предыдущий график, если он существует
    // Это важно для предотвращения наложения графиков при повторном вызове
    if (chartInstance !== null) {
        chartInstance.destroy();
    }

    // Настройки (конфигурация) для графика
    const options = {
        responsive: true, // График адаптируется под размер контейнера
        maintainAspectRatio: false, // Отключаем сохранение пропорций для полного контроля

        // Настройки плагинов Chart.js
        plugins: {
            // Настройка легенды (подписи данных)
            legend: {
                position: 'top', // Располагаем легенду сверху
                labels: {
                    color: 'white', // Белый цвет текста
                    font: {
                        size: 14 // Размер шрифта
                    }
                }
            },
            // Настройка заголовка графика
            title: {
                display: true, // Показывать заголовок
                text: 'Прогресс изучения слов', // Текст заголовка
                color: 'white', // Белый цвет
                font: {
                    size: 16, // Размер шрифта
                    weight: 'bold' // Жирный шрифт
                }
            },
            // Настройка всплывающих подсказок (при наведении на столбец)
            tooltip: {
                backgroundColor: 'rgba(0, 0, 0, 0.8)', // Полупрозрачный черный фон
                titleColor: '#ffffff', // Белый цвет заголовка подсказки
                bodyColor: '#ffffff', // Белый цвет текста подсказки
                borderColor: '#3b82f6', // Синяя рамка
                borderWidth: 1, // Толщина рамки
                callbacks: {
                    // Кастомный формат текста в подсказке
                    label: function(context) {
                        return `Слов: ${context.raw}`; // "Слов: X"
                    }
                }
            }
        },

        // Настройки осей графика
        scales: {
            // Ось X (горизонтальная)
            x: {
                grid: {
                    color: 'rgba(255, 255, 255, 0.1)', // Светло-белые линии сетки
                    drawBorder: false // Не рисовать границу оси
                },
                ticks: {
                    color: 'white', // Белый цвет меток
                    font: {
                        size: 12 // Размер шрифта меток
                    }
                }
            },
            // Ось Y (вертикальная)
            y: {
                beginAtZero: true, // Начинать ось с нуля (важно для столбчатых диаграмм)
                grid: {
                    color: 'rgba(255, 255, 255, 0.1)', // Светло-белые линии сетки
                    drawBorder: false // Не рисовать границу оси
                },
                ticks: {
                    color: 'white', // Белый цвет меток
                    font: {
                        size: 12 // Размер шрифта меток
                    },
                    // Функция форматирования значений на оси Y
                    callback: function(value) {
                        // Показываем только целые числа (чтобы не было 1.5, 2.5 и т.д.)
                        if (value % 1 === 0) {
                            return value;
                        }
                    }
                }
            }
        },

        // Настройки анимации
        animation: {
            duration: 1000, // Длительность анимации - 1 секунда
            easing: 'easeOutQuart' // Плавная анимация с замедлением в конце
        }
    };

    // Создаем новый экземпляр графика Chart.js
    chartInstance = new Chart(ctx, {
        type: 'bar', // Тип графика - столбчатая диаграмма
        data: {
            labels: label_data, // Метки на оси X (переданные в функцию)
            datasets: [{
                label: 'Изучено слов', // Название набора данных (отображается в легенде)
                data: count_data, // Данные для отображения (переданные в функцию)

                // Массив цветов для заливки каждого столбца
                backgroundColor: [
                    'rgba(59, 130, 246, 0.7)',  // Полупрозрачный синий (RGB: 59,130,246, прозрачность 70%)
                    'rgba(16, 185, 129, 0.7)',  // Полупрозрачный зеленый
                    'rgba(245, 158, 11, 0.7)',  // Полупрозрачный желтый
                    'rgba(239, 68, 68, 0.7)',   // Полупрозрачный красный
                    'rgba(139, 92, 246, 0.7)',  // Полупрозрачный фиолетовый
                    'rgba(14, 165, 233, 0.7)',  // Полупрозрачный голубой
                    'rgba(20, 184, 166, 0.7)'   // Полупрозрачный бирюзовый
                ],

                // Массив цветов для границ каждого столбца (без прозрачности)
                borderColor: [
                    'rgb(59, 130, 246)',  // Синий
                    'rgb(16, 185, 129)',  // Зеленый
                    'rgb(245, 158, 11)',  // Желтый
                    'rgb(239, 68, 68)',   // Красный
                    'rgb(139, 92, 246)',  // Фиолетовый
                    'rgb(14, 165, 233)',  // Голубой
                    'rgb(20, 184, 166)'   // Бирюзовый
                ],

                borderWidth: 2, // Толщина границы столбцов (2 пикселя)
                borderRadius: 6, // Скругление углов столбцов (6 пикселей)
                borderSkipped: false, // Рисовать границу по всем сторонам (не пропускать низ)
            }]
        },
        options: options // Применяем настройки, объявленные выше
    });

    // Возвращаем экземпляр графика для возможности управления им извне
    return chartInstance;
};

// Экспортируем функцию для использования в других файлах
export default week;
